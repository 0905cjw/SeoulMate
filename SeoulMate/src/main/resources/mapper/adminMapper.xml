<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.seoulmate.home.dao.AdminDAO">
 	<select id="memberSelect" parameterType="com.seoulmate.home.vo.PagingVO" resultType="com.seoulmate.home.vo.MemberVO">
		select * from (select * from (select * from 
  		(select * from 
  		(select * from 
  		(select no, userid, username, tel, email, grade, reportcnt, state from member 
  		<if test='searchKey !=null and searchWord != null and searchKey != "" and searchWord !=""'>where ${searchKey} like '%${searchWord}%'</if>)
  		<if test="grade != null and grade != 0"> where grade=${grade} </if>)
  		<if test='state != null and state !=""'> where state=#{state}</if>)  
  		order by no desc)
  		where <![CDATA[rownum<=]]>${pageNum * onePageRecode} order by no asc)
  		where <![CDATA[rownum<=]]><if test="pageNum==totalPage">${lastPageRecode}</if> 
  		<if test="pageNum!=totalPage">${onePageRecode}</if> ORDER BY no DESC
  	</select>
  	<select id="memberInfo" resultType="com.seoulmate.home.vo.MemberVO">
  		select profilepic, userid, userpwd, username, to_char(birth, 'YYYY-MM-DD') birth, tel, email, reportcnt, state from member where userid=#{param1}
  	</select>
  	<select id="membertotalRecord" parameterType="com.seoulmate.home.vo.PagingVO" resultType="int">
  		select count(no) no from 
  		(select * from 
  		(select * from member 
  		<if test='searchWord !=null and searchWord != ""'>where ${searchKey} like '%${searchWord}%'</if>)
  		<if test='state !="" and state != null'>where state=#{state}</if>)
  		<if test="grade == 1 or grade == 2">where grade=${grade}</if>
  	</select>
  	<update id="memberInfoSave" parameterType="com.seoulmate.home.vo.MemberVO">
  		update member set profilePic=#{profilePic}, reportcnt=#{reportCnt}, username=#{username}, tel=#{tel}, email=#{email}, 
  		<choose>
  			<when test='state==null'>
  				state='일반'
  			</when>
  			<when test='state=="on"'>
  				state='블랙'
  			</when>
  		</choose>
  		where userid=#{userid} and birth=#{birth}
  	</update>  	
  	<select id="houseTotalRecode" parameterType="java.util.HashMap" resultType="int">
  		SELECT count(no) FROM (SELECT * FROM (SELECT * FROM
			(SELECT h.NO, h.userid, h.addr, h.HOUSESTATE, m.grade FROM HOUSEWRITE h JOIN MEMBER m ON h.userid=m.userid) 
		<if test="pagingVO.searchWord != null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
		<if test="hwVO.housestate != null and hwVO.housestate!=''">WHERE houseState='${hwVO.housestate}'</if> )
  		<if test="hwVO.grade != null and hwVO.grade!=0">WHERE grade='${hwVO.grade}'</if> 
  	</select>
  	<select id="houseOnePageListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.HouseWriteVO">
  		SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM 
			(SELECT h2.NO, h2.userid, h2.housename, h2.addr, h2.houseState, h2.reportNum, m.grade FROM 
				(SELECT h.NO, h.userid, h.housename, h.addr, h.houseState, r.reportNum FROM HOUSEWRITE h join
					(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON h.NO=r.no(+)) h2 JOIN 
						(SELECT userid, grade FROM MEMBER) m ON h2.userid=m.userid)
					<if test="pagingVO.searchWord!=null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
					<if test="hwVO.housestate != null and hwVO.housestate!=''">WHERE houseState='${hwVO.housestate}'</if> )
					<if test="hwVO.grade != null and hwVO.grade!=0">WHERE grade='${hwVO.grade}'</if> )
				ORDER BY NO DESC) 
			where <![CDATA[rownum<=]]>${pagingVO.pageNum * pagingVO.onePageRecode} order by no asc)
		where <![CDATA[rownum<=]]><if test="pagingVO.pageNum==pagingVO.totalPage">${pagingVO.lastPageRecode}</if> 
  					<if test="pagingVO.pageNum!=pagingVO.totalPage">${pagingVO.onePageRecode}</if> ORDER BY no DESC
  	</select>
  	<select id="houseDetailInfoSelect" parameterType="com.seoulmate.home.vo.HouseWriteVO" resultType="com.seoulmate.home.vo.HouseWriteVO">
  		SELECT * from	
			(SELECT h2.NO, h2.userid, h2.pno, h2.housename, h2.addr,  h2.housepic1, h2.housepic2, h2.housepic3, h2.housepic4, h2.housepic5, 
			h2.room, h2.bathroom, h2.searchPeople, h2.publicFacility, h2.writedate, h2.enddate, h2.houseState, h2.houseProfile, h2.reportNum, m.grade 
			FROM  
				(SELECT h.NO, h.userid, h.pno, h.housename ,h.addr, h.housepic1, h.housepic2, h.housepic3, h.housepic4, h.housepic5, 
				h.room, h.bathroom, h.searchPeople, h.publicFacility, h.writedate, h.enddate, h.houseState, h.houseProfile, r.reportNum FROM HOUSEWRITE h 
				join
					(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON h.NO=r.no(+) ) h2 JOIN 	
		(SELECT userid, grade FROM MEMBER) m ON h2.userid=m.userid) WHERE NO=${no} AND userid='${userid}'
  	</select>
  	<select id="propensitySelect" parameterType="int" resultType="com.seoulmate.home.vo.PropensityVO">
  		SELECT * FROM propensity WHERE pno=${param1}
  	</select>
  	<select id="houseRoomInfoSelect" parameterType="com.seoulmate.home.vo.HouseWriteVO" resultType="com.seoulmate.home.vo.HouseRoomVO">
  		SELECT * FROM HOUSEROOM WHERE NO=${no} AND userid='${userid}'
  	</select>
  	<select id="houseListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.HouseWriteVO">
  		SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM
  		(SELECT h2.NO, h2.userid, h2.housename, h2.addr, h2.houseState, h2.reportNum, m.grade 
  		FROM 
			(SELECT h.NO, h.userid, h.housename, h.addr, h.houseState, r.reportNum FROM HOUSEWRITE h 
			join
			(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON h.NO=r.no(+)) h2 
				JOIN 
				(SELECT userid, grade FROM MEMBER) m ON h2.userid=m.userid)
			<if test="pagingVO.searchWord!=null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
			<if test="hwVO.housestate != null and hwVO.housestate!=''">WHERE houseState='${hwVO.housestate}'</if> )
			<if test="hwVO.grade != null and hwVO.grade!=0">WHERE grade='${hwVO.grade}'</if> )
			ORDER BY NO DESC
  	</select>
  	<select id="mateTotalRecode" parameterType="java.util.HashMap" resultType="int">
  		SELECT count(no) FROM (SELECT * FROM (SELECT * FROM
			(SELECT mate.no, mate.userid, mate.area, mate.matestate, m.grade FROM mateWrite mate JOIN MEMBER m ON mate.userid=m.userid) 
		<if test="pagingVO.searchWord != null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
		<if test="mwVO.matestate != null and mwVO.matestate!=''">WHERE matestate='${mwVO.matestate}'</if> )
  		<if test="mwVO.grade != null and mwVO.grade!=0">WHERE grade='${mwVO.grade}'</if> 
  	</select>
  	<select id="mateOnePageListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.MateWriteVO">
	  	SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM 
				(SELECT mate2.NO, m.username, mate2.userid, mate2.area, mate2.matestate, mate2.reportNum, m.grade FROM 
					(SELECT mate.NO, mate.userid, mate.area, mate.matestate, r.reportNum FROM MATEWRITE mate join
						(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON mate.NO=r.no(+)) mate2 JOIN 
							(SELECT userid, username, grade FROM MEMBER) m ON mate2.userid=m.userid)
						<if test="pagingVO.searchWord!=null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
						<if test="mwVO.matestate != null and mwVO.matestate!=''">WHERE matestate='${mwVO.matestate}'</if> )
						<if test="mwVO.grade != null and mwVO.grade!=0">WHERE grade='${mwVO.grade}'</if> )
					ORDER BY NO DESC) 
				where <![CDATA[rownum<=]]>${pagingVO.pageNum * pagingVO.onePageRecode} order by no asc)
			where <![CDATA[rownum<=]]><if test="pagingVO.pageNum==pagingVO.totalPage">${pagingVO.lastPageRecode}</if> 
	  					<if test="pagingVO.pageNum!=pagingVO.totalPage">${pagingVO.onePageRecode}</if> ORDER BY no DESC
  	</select>
  	<select id="mateDetailInfoSelectMateWrite" parameterType="com.seoulmate.home.vo.MateWriteVO" resultType="com.seoulmate.home.vo.MateWriteVO">
		SELECT * FROM (SELECT m.NO, m.userid, m.pno, m.area, m.matepic1, m.matepic2, m.matepic3, m.deposit, m.rent, m.enterdate, 
						m.minstay, m.maxstay, m.writedate, m.enddate, m.mateState, m.mateProfile, r.reportNum FROM MATEWRITE m 
		join
		(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON m.NO=r.no(+) ) WHERE NO=${no} AND userid='${userid}'
  	</select>
  	<select id="mateDetailInfoSelectMember"  parameterType="String" resultType="com.seoulmate.home.vo.MemberVO">
  		SELECT * FROM MEMBER WHERE userid='${param1}'
  	</select>
  	<select id="mateListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.MateWriteVO">
		SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * 
		FROM 
			(SELECT mate2.NO, m.username, mate2.userid, mate2.area, mate2.matestate, mate2.reportNum, m.grade 
			FROM 
				(SELECT mate.NO, mate.userid, mate.area, mate.matestate, r.reportNum FROM MATEWRITE mate 
				join
					(SELECT NO, count(num) AS reportNum FROM report GROUP BY NO) r ON mate.NO=r.no(+)) mate2 
					JOIN 
					(SELECT userid, username, grade FROM MEMBER) m ON mate2.userid=m.userid)
				<if test="pagingVO.searchWord!=null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%'</if>)
				<if test="mwVO.matestate != null and mwVO.matestate!=''">WHERE matestate='${mwVO.matestate}'</if> )
				<if test="mwVO.grade != null and mwVO.grade!=0">WHERE grade='${mwVO.grade}'</if> ) order by no desc
  	</select>
  	<select id="payTotalRecode" parameterType="java.util.HashMap" resultType="int">
  		select count(no) from pay 
  		<if test="pagingVO.searchWord != null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%' <if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''">and</if> </if>
  		<if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''"> 
  			<if test="pagingVO.searchWord == null or pagingVO.searchWord ==''"> where </if>
  			<if test="payVO.selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${payVO.selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${payVO.selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
  			<if test="payVO.selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  			<if test="payVO.selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  		</if>
  	</select>
  	<select id="payOnePageListSelect" parameterType="java.util.HashMap"  resultType="com.seoulmate.home.vo.PayVO" >
  		SELECT no, userid, username, to_char(payStart, 'YYYY-MM-DD') as payStart, to_char(payEnd, 'YYYY-MM-DD') as payEnd, payMethod, refund, grade FROM 
  			(select * from (select * from (select * from 
				(SELECT pay.no, pay.userid, pay.username, pay.payStart, pay.payEnd, pay.payMethod, pay.refund, m.grade 
				FROM pay pay, (SELECT userid, grade FROM member) m WHERE pay.userid = m.userid)
  					<if test="pagingVO.searchWord != null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%' <if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''">and</if></if>
  					<if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''"> 
  						<if test="pagingVO.searchWord==null or pagingVO.searchWord == '' "> where</if>
			  			<if test="payVO.selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${payVO.selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${payVO.selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
			  			<if test="payVO.selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
			  			<if test="payVO.selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  					</if> 
  					<if test="payVO.selectStartDate==null and payVO.selectStartDate=='' and payVO.selectEndDate==null and payVO.selectEndDate==''">)</if>
  					order by ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'"> desc</if><if test="payVO.orderUpDown=='asc'"> asc</if> )
  				where <![CDATA[rownum<=]]>${pagingVO.pageNum * pagingVO.onePageRecode} order by ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'"> asc</if><if test="payVO.orderUpDown=='asc'"> desc</if>)
  			where <![CDATA[rownum<=]]><if test="pagingVO.pageNum==pagingVO.totalPage">${pagingVO.lastPageRecode}</if> 
  					<if test="pagingVO.pageNum!=pagingVO.totalPage">${pagingVO.onePageRecode}</if> ORDER BY ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'">desc</if><if test="payVO.orderUpDown=='asc'">asc</if>)
  	</select>
  	<select id="payListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.PayVO">
  	select no, userid, username, to_char(payStart, 'YYYY-MM-DD') as payStart, to_char(payEnd, 'YYYY-MM-DD') as payEnd, payMethod, refund, grade from 
		(SELECT pay.no, pay.userid, pay.username, pay.payStart, pay.payEnd, pay.payMethod, pay.refund, m.grade 
		FROM 
		pay pay, (SELECT userid, grade FROM member) m WHERE pay.userid = m.userid)
  			<if test="pagingVO.searchWord != null and pagingVO.searchWord != '' ">where ${pagingVO.searchKey} like '%${pagingVO.searchWord}%' <if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''">and</if></if>
  			<if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''"> 
  				<if test="pagingVO.searchWord==null or pagingVO.searchWord == '' "> where</if>
			  	<if test="payVO.selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${payVO.selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${payVO.selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
			  	<if test="payVO.selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
			  	<if test="payVO.selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  			</if> 
  			<if test="payVO.selectStartDate==null and payVO.selectStartDate=='' and payVO.selectEndDate==null and payVO.selectEndDate==''">)</if>
  			order by no desc
  	</select>
  	<select id="salesOnePageListSelect"  parameterType="java.util.HashMap"  resultType="com.seoulmate.home.vo.PayVO" >
	SELECT to_char(payStart, 'YYYY-MM-DD') payStart, amount, amountCard, amountCash from  
  		(SELECT * FROM (SELECT * FROM (SELECT * FROM 
			(SELECT p.payStart, p.amount , p.amountCard, cash.amountCash 
				FROM 
					(SELECT pay.payStart, pay.amount, card.amountCard 
					FROM pay pay 
						join (SELECT payStart, amount AS amountCard FROM pay WHERE payMethod='card') card 
						on pay.payStart=card.payStart(+)) p 
				join (SELECT payStart, amount AS amountCash FROM pay WHERE payMethod!='card') cash 
				on p.payStart=cash.payStart(+) ) 
				<if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''"> 
					WHERE
		  			<if test="payVO.selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${payVO.selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${payVO.selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
		  			<if test="payVO.selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
		  			<if test="payVO.selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  				</if>  ORDER BY ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'"> desc</if><if test="payVO.orderUpDown=='asc'"> asc</if>)
	  		WHERE <![CDATA[rownum<=]]>${pagingVO.pageNum * pagingVO.onePageRecode} order by ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'"> asc</if><if test="payVO.orderUpDown=='asc'"> desc</if>)
  		WHERE <![CDATA[rownum<=]]><if test="pagingVO.pageNum==pagingVO.totalPage">${pagingVO.lastPageRecode}</if> 
  					<if test="pagingVO.pageNum!=pagingVO.totalPage">${pagingVO.onePageRecode}</if> ORDER BY ${payVO.orderCondition} <if test="payVO.orderUpDown=='desc'">desc</if><if test="payVO.orderUpDown=='asc'">asc</if>)
  	</select>
  	<select id="salesTotalAmountSelect" parameterType="com.seoulmate.home.vo.PayVO"  resultType="com.seoulmate.home.vo.PayVO">
		SELECT payStart , sum(amount) AS amount, sum(amountCard) AS amountCard, sum(amountCash) AS amountCash from 
			(SELECT TO_char(payStart, 'YYYY') AS payStart, amount, amountCard, amountCash 
				from
				(SELECT p.payStart, p.amount, p.amountCard, cash.amountCash
					FROM
					(SELECT pay.payStart, pay.amount, card.amountCard 
						FROM pay pay 
						JOIN 
						(SELECT payStart, amount AS amountCard FROM pay WHERE payMethod = 'card') card 
					ON pay.payStart = card.payStart(+)) p 
					JOIN 
					(SELECT payStart, amount AS amountCash FROM pay WHERE payMethod != 'card') cash 
				ON p.payStart = cash.payStart(+) ) 
			<if test="selectStartDate!=null and selectStartDate!='' and selectEndDate!=null and selectEndDate!=''"> 
				WHERE
		  		<if test="selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
		  		<if test="selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${selectStartDate}-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
		  		<if test="selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${selectStartDate}-1-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
  			</if>)
 		GROUP BY payStart
  	</select>
  	<select id="salesListSelect" parameterType="java.util.HashMap" resultType="com.seoulmate.home.vo.PayVO">
  	SELECT to_char(payStart, 'YYYY-MM-DD') payStart, amount, amountCard, amountCash 
  		from 
  		(SELECT p.payStart, p.amount , p.amountCard, cash.amountCash 
			FROM 
			(SELECT pay.payStart, pay.amount, card.amountCard 
			FROM 
			pay pay join (SELECT payStart, amount AS amountCard FROM pay WHERE payMethod='card') card 
			on pay.payStart=card.payStart(+)) p 
			join 
			(SELECT payStart, amount AS amountCash FROM pay WHERE payMethod!='card') cash 
			on p.payStart=cash.payStart(+) 
		) 
	<if test="payVO.selectStartDate!=null and payVO.selectStartDate!='' and payVO.selectEndDate!=null and payVO.selectEndDate!=''"> 
	WHERE
	  	<if test="payVO.selectYearMonthDate=='일별'"> payStart BETWEEN to_date('${payVO.selectStartDate} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date('${payVO.selectEndDate} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')</if>
		<if test="payVO.selectYearMonthDate=='월별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
	  	<if test="payVO.selectYearMonthDate=='년별'"> payStart BETWEEN to_date('${payVO.selectStartDate}-1-1 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and to_date(to_char(LAST_DAY(to_date('${payVO.selectEndDate}-12', 'YYYY-MM')), 'YYYY-MM-DD')||' 23:59:59' ,'YYYY-MM-DD HH24:MI:SS')</if>
	</if>  ORDER BY payStart desc
  	
  	</select>
</mapper>